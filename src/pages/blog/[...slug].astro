---
import { type CollectionEntry, getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
    const posts = await getCollection("blog");
    return posts.map((post) => ({
        params: { slug: post.slug },
        props: post,
    }));
}

type Props = CollectionEntry<"blog">;

const post = Astro.props;
const { Content } = await post.render();
---

<Layout title={`${post.data.title} | thekorn.dev`}>
    <div
        class="bg-(--color-bg-dim) border border-(--color-border) rounded-lg overflow-hidden shadow-[0_4px_20px_rgba(0,0,0,0.3)]"
    >
        <div
            class="bg-(--color-bg-dimmer) px-4 py-2.5 flex items-center gap-2 border-b border-(--color-border)"
        >
            <span class="w-3 h-3 rounded-full bg-[#cc241d]"></span>
            <span class="w-3 h-3 rounded-full bg-[#d79921]"></span>
            <span class="w-3 h-3 rounded-full bg-[#98971a]"></span>
            <span class="ml-auto text-xs text-(--color-fg-dim)"
                >thekorn.dev: ~/blog/{post.slug}</span
            >
        </div>
        <div class="p-6">
            <article class="prose">
                <header class="mb-8">
                    <div class="flex items-center gap-4 mb-4">
                        <span class="text-(--color-accent)">$</span>
                        <h1 class="text-2xl font-bold text-(--color-fg0) m-0">
                            {post.data.title}
                        </h1>
                    </div>
                    <time class="text-sm text-(--color-fg-dim)">
                        Last commit: {
                            post.data.pubDate.toLocaleDateString("en-us", {
                                year: "numeric",
                                month: "long",
                                day: "numeric",
                            })
                        }
                    </time>
                </header>
                <Content />
            </article>
            <div class="mt-10 pt-6 border-t border-(--color-border)">
                <a
                    href="/"
                    class="inline-flex items-center gap-2 text-sm text-(--color-fg-dim) no-underline transition-all duration-150 hover:text-(--color-accent-yellow)"
                >
                    <span class="text-(--color-accent-purple)">&#8592;</span> cd ..
                </a>
            </div>
        </div>
    </div>
</Layout>
