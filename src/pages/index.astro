---
import { getCollection } from 'astro:content';
import CTAButton from '@components/CTAButton';
import PostItem from '@components/PostItem';
import Layout from '@layouts/Layout.astro';
import { mainWebsite, personSchema } from '@utils/structuredData';
import Github from 'lucide-solid/icons/github';
import Linkedin from 'lucide-solid/icons/linkedin';
import Mail from 'lucide-solid/icons/mail';
import Shell from '@components/Shell';

const jsonLd = {
  '@context': 'https://schema.org',
  '@graph': [mainWebsite, personSchema],
};

const posts = (
  await getCollection('blog', ({ data }) => {
    if (import.meta.env.PROD) {
      return !data.draft;
    }
    return true;
  })
).sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout title="thekorn.dev">
  <script is:inline type="application/ld+json" set:html={JSON.stringify(jsonLd)} />
  <Shell path="~">
    <div class="p-6">
      <header class="mb-10">
        <p class="mb-2 text-(--color-accent)">
          <span class="text-(--color-accent-purple)">$</span>whoami
        </p>
        <h1 class="text-3xl font-bold text-(--color-fg0)">thekorn</h1>
        <p class="mt-2 text-lg text-(--color-fg-dim)">Software engineer, developer, creator</p>
      </header>

      <section class="mb-10">
        <p class="mb-2 text-(--color-accent)">
          <span class="text-(--color-accent-purple)">$</span>cat about.txt
        </p>
        <p class="text-lg leading-relaxed text-(--color-fg) mb-6">
          Welcome to my personal website. I'm a software engineer and I love building things for the
          web and I write about software development, programming, and technology.
        </p>
        <div class="flex flex-wrap gap-3">
          <CTAButton
            href="https://github.com/thekorn"
            icon={Github}
            target="_blank"
            rel="noopener noreferrer"
          >
            thekorn
          </CTAButton>
          <CTAButton
            href="https://www.linkedin.com/in/markuskorn/"
            icon={Linkedin}
            target="_blank"
            rel="noopener noreferrer"
          >
            markuskorn
          </CTAButton>
          <CTAButton href="mailto:hello@thekorn.dev" icon={Mail} hoverColor="purple">
            hello@thekorn.dev
          </CTAButton>
        </div>
      </section>

      <section>
        <p class="mb-4 text-(--color-accent)">
          <span class="text-(--color-accent-purple)">$</span>alias ll="eza --icons --long
          --no-permissions --no-filesize --no-permissions --no-git"
        </p>
        <p class="mb-4 text-(--color-accent)">
          <span class="text-(--color-accent-purple)">$</span>ll ./blog
        </p>
        <ul class="list-none p-0">
          {posts.map((post) => <PostItem post={post} />)}
        </ul>
      </section>

      <div class="mt-12 pt-6 border-t border-(--color-border)">
        <p class="text-sm text-(--color-fg-dim)">
          <span class="text-(--color-accent-purple)">&#10094;</span>_
        </p>
      </div>
    </div>
  </Shell>
</Layout>
